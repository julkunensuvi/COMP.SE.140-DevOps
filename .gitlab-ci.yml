stages:
  - build
  - test
  - deploy

build:
  stage: build
  image: docker:20-dind
  services:
    - name: docker:20-dind
      command: ["--tls=false"]
  variables:
    DOCKER_DRIVER: overlay
    DOCKER_HOST: tcp://127.0.0.1:2375/
    DOCKER_TLS_CERTDIR: ""

  script:
    - echo "Using Docker Compose version:"
    - docker-compose version
    - echo "Building..."
    - docker-compose build

test:
  stage: test
  script:
    - echo "Running tests... TODO"

deploy:
  stage: deploy
  script:
    - echo "Deploying..."